<script>
    window.PlutoniumBehaviors = window.PlutoniumBehaviors || {};
    PlutoniumBehaviors.CmBehavior = {
        properties: {
            sectionDisplay: {
                type: Boolean,
                notify: true,
                value: false
            },
            actionsDisplay: {
                type: Boolean,
                notify: true,
                value: false,
                observer: 'showActions'
            },
            name: {
                type: String,
                notify: true
            },
            title: {
                type: String,
                notify: true
            },
            data: {
                type: String,
                notify: true
            },
            inlineEditor: {
                type: Boolean,
                notify: true,
                value: false
            },
            _edited: {
                type: Boolean,
                notify: true,
                value: false
            },
            dialogId: {
                type: String,
                notify: true
            }
        },
        listeners: {
            'showEditor': 'onShowEditor',
            'removeSection': 'onRemoveSection',
//            'addSection': 'onAddSection',
//            'embedVideo': 'onEmbedVideo',
//            'embedImage': 'onEmbedImage',
//            'embedLink': 'onEmbedLink',
            'mouseover': 'onHovered',
            'mouseout': 'onUnhovered',
//            'moveUpSection:': 'onMoveUpSection',
//            'moveDownSection:': 'onMoveDownSection'
        },
        ready: function () {
            this.customStyle['--plutonium-cm-field-display'] = 'inline-block';

            console.log('plutonium-field[' + this.name + '] is ready.');
            console.log('\tstate: ' + (this.inlineEditor === true ? 'inline' : 'dialog') + ', ' + (this._edited === true ? 'editor' : 'preview'));
        },
        onRemoveSection: function () {
            console.log('Remove field[' + this.name + ']');
            this.fire('remove', {
                key: this.name
            });
        },
        onShowEditor: function (model) {
            this._edited = true;
            this.data = model;
            if (this.inlineEditor === false) {
                console.log('Open field[' + Polymer.dom(this).parentNode.parentNode.name + '] editor in a dialog.');
                Polymer.dom(this).parentNode.parentNode.$$('#' + this.dialogId).open();
            } else {
                console.log('Show field[' + this.name + '] editor inline.');
            }
        },
        applyModel: function () {
            this._edited = false;
            this.fire('applyModel', {
                key: this.name,
                model: this.data
            });
            console.log('Show preview.');
        },
        onHovered: function () {
            this.actionsDisplay = true;
            this.showActions();
//            console.log('hovered (' + this.getComputedStyleValue('--plutonium-cm-actions-display') + ')');
        },
        onUnhovered: function () {
            this.actionsDisplay = false;
            this.showActions();
//            console.log('unhovered (' + this.getComputedStyleValue('--plutonium-cm-actions-display') + ')');
        },
        showActions: function (value) {
            this.customStyle['--plutonium-cm-actions-display'] = (this.actionsDisplay ? 'inline-block' : 'none') + ' !important';
            this.updateStyles();
        },
        onAddSection: function () {
            console.log('Add section after field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
            this.fire('create', {
                type: 'plutonium-cm-text'
            });
        },
        onEmbedVideo: function () {
            console.log('Embed video to after field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
        },
        onEmbedImage: function () {
            console.log('Embed image to after field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
        },
        onEmbedLink: function () {
            console.log('Embed link to after field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
        },
        onMoveUpSection: function () {
            console.log('Move up field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
        },
        onMoveDownSection: function () {
            console.log('Move down field[' + Polymer.dom(this).parentNode.parentNode.name + ']');
        }
    };
</script>